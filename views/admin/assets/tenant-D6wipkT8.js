import{u as h,e as r,f as n,g as c,p as l,h as u}from"./index-CZ-jeGgE.js";const f=h(),g=r("tenant",{state:()=>({page:1,limit:10,total:0,items:[],index:-1,search:"",pages:[10,25,50,100],valid:!1,loading:!1,dialog:!1,dialogDetail:!1,dialogReset:!1,headers:()=>{const{t}=n(),e=[{title:t("text.name"),key:"name",width:"10%"},{title:t("text.username"),key:"username",width:"10%"},{title:t("text.keycode"),key:"keycode",width:"10%"},{title:t("text.status"),key:"data_status",width:"5%"},{title:t("text.updated_by"),key:"updated_by",width:"5%"},{title:t("text.updated_at"),key:"updated_at",width:"5%"}];return f.hasPermissions(["tenant_update","tenant_delete"])&&e.push({title:t("text.actions"),key:"actions",width:"5%",align:"center",sortable:!1}),e},rules:()=>{const{t}=n();return{required:e=>!!e||t("rule.required"),min1:e=>!!e&&e.length>0||t("rule.required"),email:e=>!!e&&/.+@.+/.test(e)||t("rule.email")}},filter:{search:null,data_status:null},model:{tenant_id:"",name:"",username:"",phone:"",email:"",keycode:"",data_status:null,scope_types:[],password:""},default:{tenant_id:"",name:"",username:"",phone:"",email:"",keycode:"",data_status:null,scope_types:[],password:""}}),actions:{async fnSearch(){this.search=Math.random().toString()},async fnList({page:t=1,itemsPerPage:e=10,sortBy:s=[]}){this.loading=!0;const i={page:t,limit:e,sorts:s.length?`${s[0].key}.${s[0].order}`:""};for(const a of Object.keys(this.filter))this.filter[a]&&(i[a]=this.filter[a]);const{data:{items:d,total:o}}=await c({url:"/cms/v1/tenants",params:i});this.items=d,this.total=o,this.loading=!1},async fnCancel(){this.index=-1,this.dialog=!1,this.dialogDetail=!1,this.dialogReset=!1,this.model=Object.assign({},this.default)},async fnDetailItem(t){this.dialogDetail=!0,this.model=Object.assign({},t),this.index=this.items.indexOf(t)},async fnEditItem(t){this.dialog=!0,this.model=Object.assign({},t),this.index=this.items.indexOf(t)},async fnResetItem(t){this.dialogReset=!0,this.model=Object.assign({},t),this.index=this.items.indexOf(t)},async fnSave(){if(this.loading=!0,this.valid){const{success:t,data:e}=this.index==-1?await l({url:"/cms/v1/tenants",body:this.model}):await u({url:`/cms/v1/tenants/${this.model.tenant_id}`,body:this.model});t&&(this.index==-1?this.items.unshift(e):this.items[this.index]=e,await this.fnCancel())}this.loading=!1},async fnReset(){this.loading=!0;const{success:t,data:e}=await l({url:`/cms/v1/tenants/${this.model.tenant_id}/reset-password`,body:{}});t&&(this.model=Object.assign({},e)),this.loading=!1}}});export{g as u};
